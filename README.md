# PD_Clustering

# Brief description

The repository contains the code of HSE Center of Language and Brain's project entitled Speech profile tool for generalized linguistic personality in the diagnosis of mental disorders ([–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ—á–µ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –æ–±–æ–±—â–µ–Ω–Ω–æ–π —è–∑—ã–∫–æ–≤–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤](https://stratpro.hse.ru/resilient-brain/#subproject14)). It contains the preprocessing of language materials, the implementation of clustering algorithm according to [Lundin et. al](https://www.sciencedirect.com/science/article/abs/pii/S016517812200018X) and metrics calculation.

# –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–î–∞–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ "[–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ—á–µ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –æ–±–æ–±—â–µ–Ω–Ω–æ–π —è–∑—ã–∫–æ–≤–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤](https://stratpro.hse.ru/resilient-brain/#subproject14)" –¶–µ–Ω—Ç—Ä–∞ –Ø–∑—ã–∫–∞ –∏ –ú–æ–∑–≥–∞ –ù–ò–£ –í–®–≠ - –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥. 

**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –±–ª–æ–∫–∏ –∫–æ–¥–∞**: 

- –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —è–∑—ã–∫–æ–≤—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤,
- —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–µ [Lundin et. al](https://www.sciencedirect.com/science/article/abs/pii/S016517812200018X)
- –ø–æ–¥—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏.

–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω–æ –Ω–∏–∂–µ.

# –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

1. –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
2. [–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —è–∑—ã–∫–æ–≤—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤](#–ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞-—è–∑—ã–∫–æ–≤—ã—Ö-–º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤)
3. [–ê–ª–≥–æ—Ä–∏—Ç–º –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏](#–∞–ª–≥–æ—Ä–∏—Ç–º-–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏)
4. [–ú–µ—Ç—Ä–∏–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏](#–º–µ—Ç—Ä–∏–∫–∏-–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏)

## –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —è–∑—ã–∫–æ–≤—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

–î–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞–Ω–∏—è –∞—É–¥–∏–æ–∑–∞–ø–∏—Å–µ–π —Ä–µ—á–∏ –∏—Å–ø—ã—Ç—É–µ–º—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –º–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è [Whisper](https://github.com/openai/whisper). 

–ü–æ—Å–ª–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–∫—Å—Ç—ã **–ø—Ä–µ–¥–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å –≤ 4 —Ñ–æ—Ä–º–∞—Ç–∞—Ö** :

- —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—Å–µ—Ö —Ç–æ–∫–µ–Ω–æ–≤
- —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è —Å —É–¥–∞–ª–µ–Ω–∏–µ–º —Å—Ç–æ–ø-—Å–ª–æ–≤
- –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—Å–µ—Ö —Ç–æ–∫–µ–Ω–æ–≤
- –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å —É–¥–∞–ª–µ–Ω–∏–µ–º —Å—Ç–æ–ø-—Å–ª–æ–≤

–î–ª—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å Preprocessing (—Å–º. src). –ö–ª–∞—Å—Å —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è **—Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏** –ø—Ä–∏—Ö–æ–¥—è—â–µ–≥–æ –Ω–∞ –≤—Ö–æ–¥ —Ç–µ–∫—Å—Ç–∞ **–≤ –¥–≤—É—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö**:

```python
  def tokenize(self, text):
		"""
		Getting all tokens, except punctuation marks
		Return: list of tokens with stopwords, list of tokens without stopwords
		"""
		tokens = word_tokenize(text)
		tokens_w_stops = ', '.join([i.lower() for i in tokens if (i not in punctuation)])
		tokens_wo_stops = ', '.join([i.lower() for i in tokens if (i not in punctuation) and (i not in self.stop_words)])
		return tokens_w_stops, tokens_wo_stops
```

–ê —Ç–∞–∫–∂–µ –¥–ª—è **–ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏–∏** –ø—Ä–∏—Ö–æ–¥—è—â–µ–≥–æ –Ω–∞ –≤—Ö–æ–¥ —Ç–µ–∫—Å—Ç–∞ –≤ –¥–≤—É—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö:

```python
  def lemmatize(self, text):
    """
    Getting lemmas from text with and without stopwords
    Return: list of lemmas with stopwords, list of lemmas without stopwords
    """
    doc = self.nlp(text)
    lemmas = ', '.join([token.lemma_.lower() for token in doc if (token.text not in punctuation)])
    lemmas_without_stops = ', '.join([token.lemma_.lower() for token in doc if (token.text not in punctuation) and (token.text not in self.stop_words)])
    return lemmas, lemmas_without_stops
```

–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∑–Ω–∞–∫–æ–≤ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è, –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É, —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–ø-—Å–ª–æ–≤ –≤–∑—è—Ç –∏–∑ [–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ NLTK](https://www.nltk.org/).

## –ê–ª–≥–æ—Ä–∏—Ç–º –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

1. [DataExtraction module](#dataextraction-module)
2. [Models module](#models-module)
3. [Vectorizer module](#vectorizer-module)
4. [Clusterizer module](#clusterizer-module)
5. [ClustersData module](#clustersdata-module)

### DataExtraction module

–ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Excel, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã:

- —Å–ø–∏—Å–æ–∫ ID —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–æ–≤

```python
def get_ids(self, sheet_name: str = 'healthy') -> pd.DataFrame:
	  """
	  Getting ID column
	  """
	  if sheet_name == 'healthy':
	      return self.dataset_norm['speakerID']
	  return self.dataset_pd['ID']
```

- —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –≤ 4 –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö (–≤ —Ñ–æ—Ä–º–∞—Ç–µ Series)

```python
def get_series(self,
               sheet_name: str,
               category: str) -> pd.DataFrame:
    """
    Getting one of 8 columns:
      from one of the 2 pages of the dataset
      from one of the 4 categories

    sheet_name: healthy | PD
    category: tokens | tokens_without_stops | lemmas | lemmas_without_stops
    """
    if sheet_name == 'healthy':
        return self.dataset_norm[category]

    return self.dataset_pd[category]
```


### Models module

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥–µ–ª–∏ Geowac (***geowac_lemmas_none_fasttextskipgram_300_5_2020*)** –∏–∑ –∫–æ—Ä–ø—É—Å–∞ [RusVectores](https://rusvectores.org/ru/models/). –ú–æ–¥–µ–ª—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –∫–æ—Ä–ø—É—Å–µ Geowac —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º fasttext.

### Vectorizer module

–ü–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –º–æ–¥–µ–ª—å –¥–ª—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä—ã –º–µ—Ç–æ–∫ **Beginning of Sequence** (BOS), **Pre-End of Sequence** (PEOS) –∏ **End of Sequence** (EOS) –≤ —Å–ª–æ–≤–∞—Ä—å –≤–µ–∫—Ç–æ—Ä–æ–≤. –î–∞–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏, —Ç.–∫. –ø–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ –∏–º–µ–µ—Ç –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–≤–Ω–æ–µ 0 –∑–∞ –Ω–µ–∏–º–µ–Ω–∏–µ–º –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏—Ö (–∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –º–µ–∂–¥—É —Ç–µ–∫—É—â–∏–º —Å–ª–æ–≤–æ–º –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–º).

–ú–æ–¥—É–ª—å –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–æ–≤–∞—Ä—è –≤ json —Ñ–æ—Ä–º–∞—Ç–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ö—Ä–∞–Ω—è—Ç—Å—è —Å–ª–æ–≤–∞ –∏ –∏—Ö –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–æ–≤–∞—Ä—è**: *–∫–ª—é—á ‚Äî —Å–ª–æ–≤–æ, –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî –≤–µ–∫—Ç–æ—Ä, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∏–∑ –º–æ–¥–µ–ª–∏ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏*. –°–ª–æ–≤–∞—Ä—å —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ –∫–æ—Ä–ø—É—Å—É —Ç–µ–∫—Å—Ç–æ–≤ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Å–ª–æ–≤.

**–°–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

1. –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–ª–æ–≤–∞—Ä—è –∫–ª–∞—Å—Å–∞ `update_dict(self, words: str)`
2. –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è json-—Ñ–∞–π–ª–∞ `update_json(self)`
3. –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–æ–≤ —Å –º–µ—Ç–∫–∞–º–∏ –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ `get_sequence(words_string: str)`
4. –§—É–Ω–∫—Ü–∏—è getter —Å–ª–æ–≤–∞—Ä—è `get_dictionary(self)`

### Clusterizer module

<aside>
üí°

**TLDR**: –ú–æ–¥—É–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ –∏ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ (*Davies Bouldin index + Silhouette Score*)

</aside>

–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–π –≤ —Ä–∞–±–æ—Ç–µ [Lundin et al.](https://www.sciencedirect.com/science/article/abs/pii/S016517812200018X), —Å–æ–≥–ª–∞—Å–Ω–æ –∫–æ—Ç–æ—Ä–æ–π –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–ª–æ–≤ $A, B, C, D$ **–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ—Å–ª–µ —Å–ª–æ–≤–∞** $B$ –≤ —Å–ª—É—á–∞–µ, **–∫–æ–≥–¥–∞** $S(A, B) > S(B, C)$ –∏ $S(B, C) < S(C, D)$, –≥–¥–µ $S(A, B)$ ‚Äì –∫–æ—Å–∏–Ω—É—Å–Ω–∞—è –±–ª–∏–∑–æ—Å—Ç—å –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–∞–º–∏ —Å–ª–æ–≤ $A$ –∏ $B$.

–ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ: `np.dot(v1, v2) / (np.linalg.norm(v1) * np.linalg.norm(v2))`, –≥–¥–µ v1, v2 ‚Äî –≤–µ–∫—Ç–æ—Ä—ã —Å–ª–æ–≤. –í —Å–ª—É—á–∞–µ —Å –º–æ–¥–µ–ª—å—é Geowac –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥ similarity.

**–°–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

1. –§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å—á–µ—Ç–∞ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è `get_cosine_similarity(self, w1, w2)`
2. –§—É–Ω–∫—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ `cluster(self, word_sequence: list[str])` 
3. –§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞–º–∏ `_custom_similarity(embedding_1, embedding_2)`. –¶–µ–Ω—Ç—Ä–æ–∏–¥ ‚Äî –≤–µ–∫—Ç–æ—Ä —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π embedding_1, embedding_2
4. –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ [Davies Bouldin index](https://scikit-learn.org/stable/modules/clustering.html#davies-bouldin-index) `davies_bouldin_index(self, cluster_sequence: list[list[str]])`
5. –§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å—á–µ—Ç–∞ [silhouette score](https://scikit-learn.org/stable/modules/clustering.html#silhouette-coefficient) `silhouette_score(self, cluster_sequence: list[list[str]])`
6. –§—É–Ω–∫—Ü–∏—è –æ—Ü–µ–Ω–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ –≤—Å–µ–º –º–µ—Ç—Ä–∏–∫–∞–º `evaluate_clustering(DB_values_page: list[float], silhouette_values: list[float])`

### ClustersDataSaver module

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ DataFrame **self.healthy_data** –∏ **self.impediment_data** –∫–ª–∞—Å—Ç–µ—Ä—ã –ø–æ –∫–∞–∂–¥–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ—á–µ–≤–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ (*—Ç–æ–∫–µ–Ω—ã –∏ –ª–µ–º–º—ã —Å–æ —Å—Ç–æ–ø-—Å–ª–æ–≤–∞–º–∏, —Ç–æ–∫–µ–Ω—ã –∏ –ª–µ–º—ã –±–µ–∑ —Å—Ç–æ–ø-—Å–ª–æ–≤;* –ø–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —è–∑—ã–∫–æ–≤—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤](#–ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞-—è–∑—ã–∫–æ–≤—ã—Ö-–º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤)) –∏ –º–µ—Ç—Ä–∏–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ (–ø–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [–ú–µ—Ç—Ä–∏–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏](#–º–µ—Ç—Ä–∏–∫–∏-–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏)).

–ü–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –º–æ–¥–µ–ª—å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (–ø–æ–¥—Ä–æ–±–Ω–µ —Å–º. [DataExtraction module](#dataextraction-module) –∏ –º–æ–¥–µ–ª—å –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (gensim.models.fasttext.FastTextKeyedVectors, –ø–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [Models module](#models-module)).

**–°–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

1. –§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å—á–µ—Ç–∞ **–∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏** `count_num_switches(self, sheet_name: str, category: str)`
2. –§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å—á–µ—Ç–∞ **—Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤** `avg_cluster_size(row: pd.Series)`
3. –§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å—á–µ—Ç–∞ **—Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏** `avg_cluster_distance(self, cluster_sequence)`
4. –§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å—á–µ—Ç–∞ [silhouette score](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html) `silhouette_score(self, cluster_sequence)`
5. –§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å—á–µ—Ç–∞ [t-score](https://blogs.helsinki.fi/slavica-helsingiensia/files/2019/11/sh34-21.pdf) –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ `–∫–ª–∞—Å—Ç–µ—Ä–∞ cluster_t_score(f_n, f_c, f_nc, N)`
6. –§—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å—á–µ—Ç–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ t-score `avg_cluster_t_score(self, cell, column_clusters)`
7. –§—É–Ω–∫—Ü–∏—è **—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ Excel —Ñ–∞–π–ª** –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –ø—É—Ç–∏ path `save_excel(self, path)`

–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π –º–µ—Ç—Ä–∏–∫–∏ —Å–º. –≤ –±–ª–æ–∫–µ [–ú–µ—Ç—Ä–∏–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏](#–º–µ—Ç—Ä–∏–∫–∏-–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏).

## –ú–µ—Ç—Ä–∏–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

–î–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:

- —Å—Ä–µ–¥–Ω–∏–π **—Ä–∞–∑–º–µ—Ä –∫–ª–∞—Å—Ç–µ—Ä–∞** (—Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤, –≤—Ö–æ–¥—è—â–∏—Ö –≤ –∫–ª–∞—Å—Ç–µ—Ä);
- —Å—Ä–µ–¥–Ω–µ–µ **—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏** (—Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤; –∑–∞ —Ü–µ–Ω—Ç—Ä–æ–∏–¥ –±–µ—Ä–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –≤ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ);
- —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ **t-score –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ (–º–µ—Ç—Ä–∏–∫–∞, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∞—è –Ω–∞—Å–∫–æ–ª—å–∫–æ –Ω–µ—Å–ª—É—á–∞–π–Ω–æ–π —è–≤–ª—è–µ—Ç—Å—è —Å–∏–ª–∞ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ –º–µ–∂–¥—É –∫–æ–ª–ª–æ–∫–∞—Ç–∞–º–∏; –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–ª–ª–æ–∫–∞—Ç–æ–≤ –±–µ—Ä—É—Ç—Å—è –≤—Å–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑ –¥–≤—É—Ö —Å–ª–æ–≤ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞).
- —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ **silhouette-score** (–º–µ—Ç—Ä–∏–∫–∞, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∞—è, –Ω–∞—Å–∫–æ–ª—å–∫–æ –±–ª–∏–∑–æ–∫ –æ–±—ä–µ–∫—Ç –∫ —Å–≤–æ–µ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥—Ä—É–≥–∏–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏: —á–µ–º –±–æ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏, —Ç–µ–º –±–ª–∏–∂–µ –æ–±—ä–µ–∫—Ç –∫ —Å–≤–æ–µ–º—É —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É).
